<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="mensalidade" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<parameter name="CONTEXT_PATH" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["C:/Documents and Settings/marcdfranc/Meus documentos/sistemas/master/master.com/WebContent/report/"]]></defaultValueExpression>
	</parameter>
	<parameter name="CONEXAO_EXTERNA" class="java.sql.Connection" isForPrompting="false">
		<defaultValueExpression><![CDATA[$P{REPORT_CONNECTION}]]></defaultValueExpression>
	</parameter>
	<parameter name="TITULO" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["RELAÇÃO DE MENSLIDADES"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT u.codigo, c.ctr, f.nome, f.sexo, f.cpf, f.nascimento, p.cadastro, m.vigencia, p.cod_unidade,
	n.descricao AS unidade, e.referencia AS ref_unidade, m.cod_lancamento, l.descricao, l.documento,
	l.emissao, l.vencimento, l.data_quitacao, l.valor, l.valor_pago, l.recebimento, l.juros,
	CASE
		WHEN l.status = 'a' THEN 'Aberto'
		WHEN l.status = 'c' THEN 'Cancelado'
		WHEN l.status = 'e' THEN 'Esornado'
		WHEN l.status = 'q' THEN 'Quitado'
		WHEN l.status = 'n' THEN 'Negociado'
		WHEN l.status = 'f' THEN 'Quitado'
	END AS status, l.multa, l.taxa
FROM mensalidade AS m
INNER JOIN usuario AS u ON(m.cod_usuario = u.codigo)
INNER JOIN fisica AS f ON(m.cod_usuario = f.codigo)
INNER JOIN pessoa AS p ON(m.cod_usuario = p.codigo)
INNER JOIN contrato as c ON(u.cod_contrato = c.codigo)
INNER JOIN lancamento AS l ON(m.cod_lancamento = l.codigo)
INNER JOIN unidade AS n ON(p.cod_unidade = n.codigo)
INNER JOIN pessoa AS e ON(p.cod_unidade = e.codigo)
WHERE p.cod_unidade = 78
ORDER BY f.nome, m.vigencia, l.vencimento DESC]]>
	</queryString>
	<field name="codigo" class="java.lang.Integer"/>
	<field name="ctr" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nome" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="sexo" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="cpf" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nascimento" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="cadastro" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="vigencia" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="cod_unidade" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="unidade" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="ref_unidade" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="cod_lancamento" class="java.lang.Integer"/>
	<field name="descricao" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="documento" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="emissao" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="vencimento" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="data_quitacao" class="java.sql.Timestamp">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="valor" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="valor_pago" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="recebimento" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="juros" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="status" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="multa" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="taxa" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<variable name="isPrint" class="java.lang.Boolean" resetType="Group" resetGroup="grp_usuario">
		<variableExpression><![CDATA[!$V{isPrint}]]></variableExpression>
	</variable>
	<group name="grp_usuario">
		<groupExpression><![CDATA[$F{codigo}]]></groupExpression>
		<groupHeader>
			<band height="31">
				<textField>
					<reportElement x="0" y="0" width="555" height="17"/>
					<textElement>
						<font size="12" isBold="false" isItalic="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["CTR: " + com.marcsoftware.Util.zeroToLeft($F{ctr}, 4) + "/" + $F{ref_unidade} + " - " +
com.marcsoftware.Util.initCap($F{nome})]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="26" y="19" width="94" height="12"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Descrição]]></text>
				</staticText>
				<staticText>
					<reportElement x="120" y="19" width="63" height="12"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Vencimento]]></text>
				</staticText>
				<staticText>
					<reportElement x="291" y="19" width="62" height="12"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Dt. Pagamento]]></text>
				</staticText>
				<staticText>
					<reportElement x="0" y="19" width="26" height="12"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Vig.]]></text>
				</staticText>
				<staticText>
					<reportElement x="411" y="19" width="92" height="12"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Usuário]]></text>
				</staticText>
				<staticText>
					<reportElement x="183" y="19" width="50" height="12"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Valor]]></text>
				</staticText>
				<staticText>
					<reportElement x="233" y="19" width="29" height="12"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Multa]]></text>
				</staticText>
				<staticText>
					<reportElement x="262" y="19" width="29" height="12"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Mora]]></text>
				</staticText>
				<staticText>
					<reportElement x="503" y="19" width="52" height="12"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[status]]></text>
				</staticText>
				<staticText>
					<reportElement x="353" y="19" width="58" height="12"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Vlr. Receb.]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="14">
				<line>
					<reportElement x="0" y="3" width="555" height="1"/>
				</line>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="49" splitType="Stretch">
			<subreport>
				<reportElement x="0" y="0" width="555" height="49"/>
				<subreportParameter name="CONTEXT_PATH">
					<subreportParameterExpression><![CDATA[$P{CONTEXT_PATH}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="COD_UNIDADE">
					<subreportParameterExpression><![CDATA[$F{cod_unidade}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="TITLE">
					<subreportParameterExpression><![CDATA[$P{TITULO}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{CONEXAO_EXTERNA}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA[$P{CONTEXT_PATH} + "comum/header.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</pageHeader>
	<detail>
		<band height="12" splitType="Stretch">
			<rectangle>
				<reportElement x="0" y="0" width="555" height="12" backcolor="#CCCCCC">
					<printWhenExpression><![CDATA[$V{isPrint}]]></printWhenExpression>
				</reportElement>
				<graphicElement>
					<pen lineWidth="0.0"/>
				</graphicElement>
			</rectangle>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="120" y="0" width="63" height="12"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{vencimento}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="0" y="0" width="26" height="12"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{vigencia} + "ª"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="185" y="0" width="48" height="12"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{valor}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="233" y="0" width="29" height="12"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{multa}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="262" y="0" width="29" height="12"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{taxa}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="291" y="0" width="62" height="12"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.sql.Timestamp"><![CDATA[$F{data_quitacao}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="26" y="0" width="94" height="12"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{descricao}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="353" y="0" width="58" height="12"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{valor_pago}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="411" y="0" width="92" height="12"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{recebimento}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="503" y="0" width="52" height="12"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{status}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="47" splitType="Stretch">
			<subreport>
				<reportElement x="0" y="0" width="555" height="47"/>
				<subreportParameter name="COD_UNIDADE">
					<subreportParameterExpression><![CDATA[$F{cod_unidade}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="CURRENT_PAGE">
					<subreportParameterExpression><![CDATA[$V{PAGE_NUMBER}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{CONEXAO_EXTERNA}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA[$P{CONTEXT_PATH} + "comum/footer.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</pageFooter>
</jasperReport>
