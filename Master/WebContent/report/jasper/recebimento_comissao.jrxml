<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="repasse_valores" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="10">
	<property name="ireport.zoom" value="1.1"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="FATURA" class="java.lang.Integer">
		<parameterDescription><![CDATA[Seleção Fatura]]></parameterDescription>
	</parameter>
	<parameter name="CONEXAO_EXTERNA" class="java.sql.Connection" isForPrompting="false">
		<parameterDescription><![CDATA[conexão externa]]></parameterDescription>
		<defaultValueExpression><![CDATA[$P{REPORT_CONNECTION}]]></defaultValueExpression>
	</parameter>
	<parameter name="CONTEXT_PATH" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["C:/Documents and Settings/Marcelo/Meus documentos/Sistemas/master/master.com/WebContent/report/"]]></defaultValueExpression>
	</parameter>
	<parameter name="TITULO" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["FATURA DE COMISSÕES"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT e.referencia AS unidade, n.descricao AS fantasia, c.cod_unidade,
	CASE
		WHEN TO_CHAR(a.fim, 'mm') = '01' THEN 'Janeiro'
		WHEN TO_CHAR(a.fim, 'mm') = '02' THEN 'Fevereiro'
		WHEN TO_CHAR(a.fim, 'mm') = '03' THEN 'Março'
		WHEN TO_CHAR(a.fim, 'mm') = '04' THEN 'Abril'
		WHEN TO_CHAR(a.fim, 'mm') = '05' THEN 'Maio'
		WHEN TO_CHAR(a.fim, 'mm') = '06' THEN 'Junho'
		WHEN TO_CHAR(a.fim, 'mm') = '07' THEN 'Julho'
		WHEN TO_CHAR(a.fim, 'mm') = '08' THEN 'Agosto'
		WHEN TO_CHAR(a.fim, 'mm') = '09' THEN 'Setembro'
		WHEN TO_CHAR(a.fim, 'mm') = '10' THEN 'Outubro'
		WHEN TO_CHAR(a.fim, 'mm') = '11' THEN 'Novembro'
		WHEN TO_CHAR(a.fim, 'mm') = '12' THEN 'Dezembro'
	END AS mes_base, TO_CHAR(a.fim, 'yyyy') AS ano_base,
	f.codigo AS funcionario, f.nome, f.cpf, f.rg,
	c.ctr, i.cod_fatura, s.nome AS titular, c.requisicao, p.cadastro,
	v.comissao, v.bonus, v.meta, l.valor
FROM contrato AS c
	INNER JOIN itens_vendedor AS i ON(i.cod_contrato = c.codigo)
	INNER JOIN funcionario AS v ON(c.cod_funcionario = v.codigo)
	INNER JOIN fisica AS f ON(f.codigo = v.codigo)
	INNER JOIN fatura_vendedor AS a ON(a.codigo = i.cod_fatura)
	INNER JOIN usuario AS u ON(u.cod_contrato = c.codigo)
	INNER JOIN fisica AS s ON(u.codigo = s.codigo)
	INNER JOIN pessoa AS p ON(p.codigo = u.codigo)
	INNER JOIN juridica AS j ON(j.codigo = p.cod_unidade)
	INNER JOIN unidade AS n ON(p.cod_unidade = n.codigo)
	INNER JOIN pessoa AS e ON(e.codigo = j.codigo)
	INNER JOIN lancamento AS l ON(l.codigo = c.cod_lancamento)
WHERE i.cod_fatura = $P{FATURA}]]>
	</queryString>
	<field name="unidade" class="java.lang.String"/>
	<field name="fantasia" class="java.lang.String"/>
	<field name="mes_base" class="java.lang.String"/>
	<field name="ano_base" class="java.lang.String"/>
	<field name="nome" class="java.lang.String"/>
	<field name="cpf" class="java.lang.String"/>
	<field name="rg" class="java.lang.String"/>
	<field name="ctr" class="java.lang.Integer"/>
	<field name="cod_fatura" class="java.lang.Integer"/>
	<field name="titular" class="java.lang.String"/>
	<field name="requisicao" class="java.util.Date"/>
	<field name="cadastro" class="java.util.Date"/>
	<field name="comissao" class="java.lang.Double"/>
	<field name="bonus" class="java.lang.Double"/>
	<field name="meta" class="java.lang.Integer"/>
	<field name="valor" class="java.lang.Double"/>
	<field name="cod_unidade" class="java.lang.Integer"/>
	<variable name="total" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{valor}]]></variableExpression>
	</variable>
	<variable name="total_guias" class="java.lang.Integer" calculation="Count">
		<variableExpression><![CDATA[$F{ctr}.toString()]]></variableExpression>
	</variable>
	<group name="GRP_FATURA" isStartNewPage="true" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{cod_fatura}]]></groupExpression>
		<groupHeader>
			<band height="40">
				<staticText>
					<reportElement x="52" y="25" width="251" height="14"/>
					<textElement>
						<font fontName="Arial" isBold="true" isItalic="false" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<text><![CDATA[Titular]]></text>
				</staticText>
				<line>
					<reportElement x="1" y="39" width="555" height="1"/>
				</line>
				<staticText>
					<reportElement x="2" y="25" width="50" height="14"/>
					<textElement>
						<font fontName="Arial" isBold="true" isItalic="false" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<text><![CDATA[CTR]]></text>
				</staticText>
				<staticText>
					<reportElement x="303" y="24" width="75" height="14"/>
					<textElement>
						<font fontName="Arial" isBold="true" isItalic="false" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<text><![CDATA[Requisicao]]></text>
				</staticText>
				<staticText>
					<reportElement x="378" y="24" width="78" height="14"/>
					<textElement>
						<font fontName="Arial" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<text><![CDATA[Cadastro]]></text>
				</staticText>
				<staticText>
					<reportElement x="457" y="24" width="97" height="14"/>
					<textElement textAlignment="Right">
						<font fontName="Arial" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<text><![CDATA[Valor]]></text>
				</staticText>
				<staticText>
					<reportElement x="1" y="3" width="200" height="21"/>
					<textElement>
						<font fontName="Arial" size="12" isBold="true" isItalic="true" pdfFontName="Helvetica-BoldOblique"/>
					</textElement>
					<text><![CDATA[Detalhamento da Fatura]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="18">
				<staticText>
					<reportElement x="465" y="0" width="30" height="15"/>
					<textElement>
						<font fontName="Arial" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<text><![CDATA[Total:]]></text>
				</staticText>
				<textField pattern="¤ #,##0.00">
					<reportElement x="496" y="0" width="59" height="15"/>
					<textElement textAlignment="Right">
						<font fontName="Arial"/>
					</textElement>
					<textFieldExpression class="java.lang.Double"><![CDATA[$V{total}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band/>
	</background>
	<pageHeader>
		<band height="53">
			<subreport>
				<reportElement x="-1" y="0" width="555" height="53"/>
				<subreportParameter name="CONTEXT_PATH">
					<subreportParameterExpression><![CDATA[$P{CONTEXT_PATH}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="COD_UNIDADE">
					<subreportParameterExpression><![CDATA[$F{cod_unidade}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="TITLE">
					<subreportParameterExpression><![CDATA[$P{TITULO}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{CONEXAO_EXTERNA}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA[$P{CONTEXT_PATH} + "comum/header.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="66">
			<staticText>
				<reportElement mode="Opaque" x="255" y="41" width="27" height="14" backcolor="#DBDADA"/>
				<textElement>
					<font fontName="Arial" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[CPF:]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="486" y="10" width="36" height="14" backcolor="#DBDADA"/>
				<textElement>
					<font fontName="Arial" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Fatura:]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="255" y="10" width="63" height="14" backcolor="#DBDADA"/>
				<textElement>
					<font fontName="Arial" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Data Base:]]></text>
			</staticText>
			<textField>
				<reportElement mode="Opaque" x="2" y="41" width="253" height="14" backcolor="#DBDADA"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.marcsoftware.Util.initCap($F{nome})]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="282" y="41" width="177" height="14" backcolor="#DBDADA"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{cpf}.substring(0, 3) + "." + $F{cpf}.substring(3, 6) + "." + $F{cpf}.substring(6, 9) + "-" + $F{cpf}.substring(9, 11)]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="478" y="41" width="77" height="14" backcolor="#DBDADA"/>
				<textElement textAlignment="Right">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{rg}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="522" y="10" width="34" height="14" backcolor="#DBDADA"/>
				<textElement textAlignment="Right">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{cod_fatura}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="318" y="10" width="168" height="14" backcolor="#DBDADA"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{mes_base} + " de " + $F{ano_base}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement mode="Opaque" x="459" y="41" width="19" height="14" backcolor="#DBDADA"/>
				<textElement>
					<font fontName="Arial" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[RG:]]></text>
			</staticText>
			<textField>
				<reportElement mode="Opaque" x="1" y="10" width="254" height="14" backcolor="#DBDADA"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{unidade} + " - " + com.marcsoftware.Util.initCap($F{fantasia})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="0" y="0" width="144" height="13"/>
				<textElement>
					<font size="8" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Unidade Administradora]]></text>
			</staticText>
			<staticText>
				<reportElement x="2" y="30" width="144" height="13"/>
				<textElement>
					<font size="8" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Funcionário]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="20">
			<textField>
				<reportElement x="0" y="3" width="52" height="14"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{ctr}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="52" y="3" width="251" height="14"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.marcsoftware.Util.initCap($F{titular})]]></textFieldExpression>
			</textField>
			<textField pattern="¤ #,##0.00">
				<reportElement x="457" y="3" width="97" height="14"/>
				<textElement textAlignment="Right">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.Double"><![CDATA[$F{valor}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="0" y="17" width="555" height="1"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</line>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="303" y="3" width="75" height="14" isRemoveLineWhenBlank="true"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{requisicao}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="378" y="3" width="78" height="14"/>
				<textElement/>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{cadastro}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="47">
			<subreport>
				<reportElement x="0" y="0" width="555" height="47"/>
				<subreportParameter name="COD_UNIDADE">
					<subreportParameterExpression><![CDATA[$F{cod_unidade}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="CURRENT_PAGE">
					<subreportParameterExpression><![CDATA[$V{PAGE_NUMBER}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{CONEXAO_EXTERNA}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA[$P{CONTEXT_PATH} + "comum/footer.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</pageFooter>
	<lastPageFooter>
		<band height="157">
			<textField evaluationTime="Report" pattern="">
				<reportElement mode="Opaque" x="124" y="72" width="184" height="15" backcolor="#DBDADA"/>
				<textElement>
					<font fontName="Arial" isUnderline="false"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$V{total_guias}]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report" pattern="¤ #,##0.00">
				<reportElement mode="Opaque" x="478" y="72" width="77" height="15" backcolor="#DBDADA"/>
				<textElement textAlignment="Right">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.Double"><![CDATA[$V{total}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="127" y="54" width="231" height="1"/>
			</line>
			<staticText>
				<reportElement x="2" y="41" width="165" height="14"/>
				<textElement>
					<font fontName="Arial" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Recebi os valores Acima:]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="303" y="72" width="175" height="15" backcolor="#DBDADA"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Total de Valores Pagos:]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="2" y="72" width="122" height="15" backcolor="#DBDADA"/>
				<textElement>
					<font fontName="Arial" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Vendas Consolidadas:]]></text>
			</staticText>
			<subreport>
				<reportElement x="1" y="107" width="555" height="50"/>
				<subreportParameter name="COD_UNIDADE">
					<subreportParameterExpression><![CDATA[$F{cod_unidade}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="CURRENT_PAGE">
					<subreportParameterExpression><![CDATA[$V{PAGE_NUMBER}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{CONEXAO_EXTERNA}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA[$P{CONTEXT_PATH} + "comum/footer.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</lastPageFooter>
</jasperReport>
